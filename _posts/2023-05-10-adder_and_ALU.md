---
title: CO2. 加法器与算术逻辑单元
author: GalaxyRover59
date: 2023-05-10  10:08:00 +0800
category: [计算机组成原理]
tags: [hardware]
math: true
layout: post
---


借助第一章中提到的逻辑门，我们可以建造一个功能齐全的算术逻辑单元(Arithmetic Logic Unit, ALU)，其作用是处理规定的算术和逻辑运算。ALU将作为中央处理单元(Central Processing Unit, CPU)的计算中心（CPU是一种执行计算机处理的所有指令的芯片）。因此，构建ALU是建造一个现代体系计算机的重要一步。

## 1. 加法器

- ### 半加器

![半加器逻辑图与真值表](/images/Half-adder.png "半加器")

通过真值表给出的逻辑关系，可以很容易的得到半加器的结构。

- ### 全加器

全加器可由两个半加器结合组成（这也是半加器名字的由来）。

![全加器逻辑图与真值表](/images/Full-adder.png "全加器")

- ### 加法器

在计算机中的加法器，一般会根据要求指定相应的运算位数，如8位、16位、32位加法器......最简单的实现方式是将相应个数的全加器串联起来即可。不过这样一来，每一位的计算都要等上一位的计算结果出来，随着位数的增多，耗时会越来越长。因此，在考虑到相应的逻辑关系后，人们设计出了并行加法器，这样就可以减少时间的消耗，代价则是电路变得复杂。而且随着位数的增大，复杂度是迅速增大的。

因此，在实际中多数会采用串行与并行结合的方式来实现加法器。

- ### 增量器

很多时候我们只需将数$x$加上1------例如在后面提到的程序计数器中------虽然使用通用的加法器（输入指令$x+1$）就可以实现，但设计专用的芯片会使得该操作更有效率。

## 2. 算术逻辑单元

到目前为止，所有提到的硬件（各逻辑门及加法器）都是通用的。之后，在这些硬件的基础上，将要开始构建一个算术逻辑单元（Arithmetic Logic Unit, ALU），这个硬件将成为我们CPU的计算核心。这个ALU的设计是独特的，应用于[Nand to Tetris](https://www.coursera.org/learn/build-a-computer)这门课程上，名为Hack。不过，Hack ALU背后的设计原则是通用的，具有指导意义的。

顾名思义，算术逻辑单元是一种设计用于计算一组算术和逻辑运算的芯片。ALU到底应该采用哪些操作是一个基于成本效益考虑的设计决策。在Hack平台的情况下，设计者决定(i)ALU将只执行整数运算（而不是浮点数运算）和（ii）ALU将计算下图中所示的18个算术逻辑函数的集合。

![HackALU](/images/HackALU.png "Hack ALU与可执行的算术逻辑运算")

Hack ALU操作两个16位二进制整型数字：x和y；以及6个1位的输入，称为控制位。这些控制位决定了所采取的算术逻辑运算，如下表所示。

![AL operation](/images/ArithmeticLogicOperation.png "控制位及对应的算术逻辑运算")

事实上，6个控制位一共可以执行 $2^6=64$ 种算术逻辑操作，并且，一些不在表中的ALU操作是相当有意义的。然而这里决定只关注并记录其中的18种，因为这些已足以支持构建目标计算机系统的指令集。

注意，除了对两个输入计算指定的函数外，ALU还有两个输出位zr和ng。它们分别标记ALU输出为零或负的情况，并将被在后续章节的CPU中使用。

根据以上的设定，我们可以大致画出ALU内部电路的一种构建方式。

![ALU](/images/ALU.png "ALU电路")

线上标有斜线意味着该线路上的是多位数据（在本章及后续相关章节中，一般为16位数据）。